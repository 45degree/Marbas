# 场景

## 资源文件

资源文件分为模型文件和其他资源(如:纹理，着色器，材质等),
将其分开的原因是因为模型文件往往比较大而且多, 将所有的模型都放在一个文件里面会影响文件的读取效率。

### 模型文件

为了方便处理, 所有的模型文件都转化成了一种自定义格式, 这里使用toml这种格式来表示模型, 需要注意的是模型文件中并没有定义每个网格所引用的纹理

示例如下:

``` toml
[model]
name = "model"

[[model.mesh]]
index = 0
vertex = [[1.0, 1.0, 1.0], [1.0, 1.0, 2.0], [2.0, 3.0, 4.0]]
normal = [[1.0, 1.0, 1.0], [1.0, 1.0, 2.0], [2.0, 3.0, 4.0]]
textureUV = [[0.2, 0.2], [0.3, 0.3], [0.4, 0.4]]
face = [[0, 1, 2]]

[[model.mesh]]
index = 1
vertex = [[1.0, 1.0, 1.0], [1.0, 1.0, 2.0], [2.0, 3.0, 4.0]]
face = [[0, 1, 2]]
```

一个模型可能包含若干个网格, 每个网格都包含顶点坐标, 法线防线, UV坐标和面索引

### 纹理，着色器，材质等其他资源


``` toml
[resource]

[[resource.texture]]
uid = 12321313
path = "texture.png"

[[resource.shader]]
uid = 23123232
vertPath = "shader.vert.glsl"
fragPath = "shader.flag.glsl"

[[resource.material]]
uid = 1231313
diffuseTextureId = 12321313
shaderId = 23123232
```

## 场景文件

场景文件同样是一个toml文件, 记录了一个场景中所有要使用的资源,
所有资源的路径都是相对于该场景文件的相对路径


``` toml
[scene]
name = "scene"
resourceFile = "resource.toml"

[[scene.node]]
type = "Model"
path = "Model.model"
position = [2, 1, 0]
rotate = [0, 0, 0]

[[scene.node.mesh]]
meshIndex = 0
materialId = 1231313

[[scene.node.mesh]]
meshIndex = 1
materialId = 1231313

[[scene.node.node]]
type = "Light"

[[scene.node]]
type = "Model"
path = "Model.model"
position = [ 0, 0, 0 ]
rotate = [ 0, 0, 0 ]

[[scene.node.mesh]]
meshIndex = 0
materialId = 1231313

[[scene.node.mesh]]
meshIndex = 1
materialId = 1231313

[[scene.node]]
type = "Light"

```

其对应的Json文件如下

``` json
{
  "scene":{
    "name":"scene",
    "resourceFile":"resource.toml",
    "node":[
      {
        "type":"Model",
        "path":"Model.model",
        "position":[ 0, 0, 0 ],
        "rotate"::[ 0, 0, 0 ],
        "mesh":[
          {
            "meshIndex":0,
            "materialId":1231313
          },
          {
            "meshIndex":1,
            "materialId":1231313
          }
        ],
        "node":[
          {
            "type":"Light"
          }
        ]
      },
      {
        "type":"Model",
        "path":"Model.model",
        "position":[ 0, 0, 0 ],
        "rotate": [ 0, 0, 0 ],
        "mesh":[
          {
            "meshIndex":0,
            "materialId":1231313
          },
          {
            "meshIndex":1,
            "materialId":1231313
          }
        ]
      },
      {
        "type":"Light"
      }
    ]
  }
}

```


### 场景节点之间的层级关系

在toml文件内部就已经定义好了模型之间的层级关系, 

```
sceen
  model
    mesh1
    mesh2
  light
```


